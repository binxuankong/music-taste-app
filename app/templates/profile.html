{% extends 'base.html' %}

{% block content %}

<style>
    table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }
</style>

{% if not user %}

    <h2>Profile</h2>
    <p>You need to link your Spotify account to see this page.</p>
    <a type="button" class="btn btn-primary" href="/link">Link</a>

{% else %}

    <h2>{% block title %} {{ user['display_name'] }} {% endblock %}</h2>
    <span class="badge badge-primary">{{ user['last_login'] }}</span>
    <p>Spotify profile: <a href="{{ user['spotify_url'] }}">{{ user['spotify_url'] }}</a></p>
    <p>Followers: {{ user['followers'] }}</p>
    <p><img src="{{ user['image_url'] }}" alt="User Image" style="width:300px;height:300px"</p>

    <div class='top-artists'>
        <h3>Your top artists: </h3>
        <table style="width:100%">
            <tr>
                <th>Rank</th>
                <th>Artist</th>
                <th>Genres</th>
                <th>Artist URL</th>
            </tr>
            <tr>
            {% for artist in artists %}
            <tr>
                <td>{{ artist['rank'] }}</td>
                <td>{{ artist['artist'] }}</td>
                <td>{{ artist['genres'] }}</td>
                <td><a href="{{ artist['artist_url'] }}">Artist Page</a></td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <div class='top-tracks'>
        <h3>Your top tracks: </h3>
        <table style="width:100%">
            <tr>
                <th>Rank</th>
                <th>Track</th>
                <th>Artists</th>
                <th>Album</th>
                <th>Track URL</th>

            </tr>
            <tr>
            {% for track in tracks %}
            <tr>
                <td>{{ track['rank'] }}</td>
                <td>{{ track['track'] }}</td>
                <td>{{ track['artists'] }}</td>
                <td>{{ track['album'] }}</td>
                <td><a href="{{ track['track_url'] }}">Open Track in Spotify</a></td>
            </tr>
            {% endfor %}
        </table>
    </div>

{% endif %}

{% endblock %}